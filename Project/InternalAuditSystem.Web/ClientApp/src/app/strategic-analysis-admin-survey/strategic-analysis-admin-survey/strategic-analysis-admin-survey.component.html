<!-- Survey list page contents -->
<app-loader></app-loader>
<div class="sector-list-page survey-list-page">
  <div class="row">
    <div class="col-md-6">
      <h4 class="page-title mb-25 ml-20">{{surveyTitle}}</h4>
    </div>
    <div class="col-md-6">
      <div class="right-contents text-right mb-35">
        <button class="btn btn-icon btn-outline-primary back-btn p-0 ml-10" tooltip="{{backToolTip}}" (click)="onBackClick()"><i class="zmdi zmdi-long-arrow-left"></i></button>
      </div>
    </div>
  </div>


  <div class="page-container">
    <div class="top-contents mb-0">
      <h4 tooltip="{{strategicAnalysis.surveyTitle}}">{{strategicAnalysis.surveyTitle}}</h4>
    </div>
  </div>

  <div class="row survey-container mt-30">
    <div class="col-xl-3 col-md-12 col-lg-4 col-xs-4 col-12">
      <h5 class="mb-20">{{dragDrop}}</h5>
      <div class="survey-sidebar">

        <ul class="p-0">
          <cdk-drop #listOne class="list-sorted" [connectedTo]="[listall]" [data]="sideBar" (dropped)="drop($event)">
            <li class="mb-10 box" *ngFor="let lists of sideBar" cdkDrag>
              <i class="zmdi zmdi-apps mr-10"></i>
              <span>{{lists.title}}</span>
              <i class="zmdi {{lists.icons}} pull-right"></i>
            </li>

          </cdk-drop>
        </ul>

      </div>
    </div>
    <div class="col-xl-9 col-lg-8 col-md-12 col-xs-8 col-12 survey-lists">
      <cdk-drop #listall class="list-sorted" [data]="listOfQuestions" (dropped)="drop($event)">
        <form class="survey-form analysis-survey">
          <ul class="w-100 pl-0" cdkDropList (cdkDropListDropped)="drop($event)">

            <cdk-drop #listall class="list-sorted" [data]="listOfQuestions" (dropped)="drop2($event)">
              <li *ngFor="let question of listOfQuestions; let index = index;" cdkDrag class="box mb-30 drag-section cursor-pointer" (click)="openModal(question.id, $event)">

                <div class="dots mb-20 showonhover" cdkDragHandle>
                  <img src="../../../assets/images/dots.png" alt="{{dots}}" />
                </div>
                <label class="mb-20"><p><span tooltip="{{question.questionText}}" class="form-label" [ngClass]="{'required': question.isRequired === true}">{{question.questionText}}</span></p></label>

                <!--For dropdown-->
                <div *ngIf="question.type === 1">
                  <ng-select #select [items]="question.options" [searchable]="false" placeholder="{{choose}}" name="options" class="disable-arrow disable-dropdown col-xl-4 col-md-8" bindLabel="item" bindValue="item">
                  </ng-select>
                </div>

                <!--For MCQ-->
                <div *ngIf="question.type === 0">
                  <div *ngFor="let opt of question.options; let i = index;">
                    <div class="form-group survey-radio">
                      <input type="radio" name="options" class="mr-10" id="{{question.id}}{{i}}" disabled>
                      <label for="{{question.id}}{{i}}" class="mb-20"><span tooltip="{{question.options[i]}}">{{question.options[i]}}</span></label>
                    </div>
                  </div>
                </div>

                <!--For Rating Scale Question-->
                <div *ngIf="question.type === 2">
                  <div *ngFor="let smiley of question.ratingScaleQuestion.resultSmileyList; let j = index;" class="parent-smiley">
                    <div id="smileys" *ngFor="let smiley of smileyValues; let i = index">
                      <input *ngIf="smileyValues[i].number === question.ratingScaleQuestion.resultSmileyList[j] && (question.ratingScaleQuestion.resultSmileyList[j] === 1)" type="radio" name="smiley"
                             value="{{smileyValues[i].value}}" class="{{smileyValues[i].class}}" tooltip="{{question.ratingScaleQuestion.startLabel}}">
                      <input *ngIf="smileyValues[i].number === question.ratingScaleQuestion.resultSmileyList[j] && (question.ratingScaleQuestion.resultSmileyList[j] !== 1) && (question.ratingScaleQuestion.resultSmileyList[j] !== 5)" type="radio" name="smiley"
                             value="{{smileyValues[i].value}}" class="{{smileyValues[i].class}}">
                      <input *ngIf="smileyValues[i].number === question.ratingScaleQuestion.resultSmileyList[j] && (question.ratingScaleQuestion.resultSmileyList[j] === 5)" type="radio" name="smiley"
                             value="{{smileyValues[i].value}}" class="{{smileyValues[i].class}}" tooltip="{{question.ratingScaleQuestion.endLabel}}">
                    </div>
                  </div>

                </div>

                <!--For Subjective Question-->
                <div *ngIf="question.type === 3">
                  <input type="text" class="col-md-8" disabled />
                </div>
                <!--For FileUpload Question-->
                <div *ngIf="question.type === 5">
                  <input style="display: none" type="file" #hiddenfileinput>
                  <button (click)="hiddenfileinput.click()" class="btn upload-btn" disabled> Upload File <i class="zmdi zmdi-upload ml-10"></i></button>
                </div>
                <!--For Textbox Question-->
                <div *ngIf="question.type === 4">
                  <input type="text" class="col-md-8" disabled />
                </div>
                <!--For Checkbox Question-->
                <div *ngIf="question.type === 6">
                  <div *ngFor="let opt of question.options; let i = index;">
                    <div class="checkbox-section">
                      <input type="checkbox" name="options" class="mr-10 styled-checkbox" id="{{question.id}}{{i}}" disabled>
                      <label for="{{question.id}}{{i}}" class="mb-20"><p class="mb-0"><span tooltip="{{question.options[i]}}">{{question.options[i]}}</span></p></label>
                    </div>
                  </div>
                </div>
                <div class="right-contents align-right showonhover">
                  <button class="btn btn-transparent p0 mr-15" (click)="duplicateQuestion(question, $event)"><i class="zmdi zmdi-copy"></i></button>
                  <button class="btn btn-transparent p0" (click)="deleteQuestion(question.id, $event)"><i class="zmdi zmdi-delete"></i></button>
                </div>


              </li>
            </cdk-drop>
          </ul>
          <div class="empty-questions mb-20" *ngIf="listOfQuestions.length===0">
            <i class="zmdi zmdi-file-plus"></i>
          </div>
          <button class="btn form-btn mb-20 mr-20" (click)="saveSurvey()">
            <img src="../../assets/images/save.png" alt="{{saveButtonText}}" class="align-top" />
            {{saveButtonText}}
          </button>
          <button class="btn form-btn mb-20" (click)="saveSurveyAsNewVersion()">
            <img src="../../assets/images/save.png" alt="{{saveButtonText}}" class="align-top" />
            {{saveAsNewVersionText}}
          </button>
        </form>
      </cdk-drop>
    </div>
  </div>
</div>

